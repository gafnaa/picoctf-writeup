# RPS

## Description
Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row.
The program's source code with the flag redacted can be downloaded here.
Connect to the program with netcat:
$ nc saturn.picoctf.net 62658

## Solution

After opened the source code, I found this

```c
read_bytes = read(0, input, l-1);

#and
if (wins >= 5) {
        puts("Congrats, here's the flag!");
        puts(flag);
      }
```

From the program, a loophole was found, namely the read function **read** data directly from STDIN without further validation of the amount of input. 

If the user enters multiple inputs in one line (separated by spaces or newlines), the program will still read all of them, without limiting only one input per execution.

So, we can try play the game by exploiting this loophole.

```
Please make your selection (rock/paper/scissors):
rock paper scissors
rock paper scissors
You played: rock paper scissors
The computer played: paper
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
rock paper scissors
rock paper scissors
You played: rock paper scissors
The computer played: scissors
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
rock paper scissors
rock paper scissors
You played: rock paper scissors
The computer played: scissors
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1
rock paper scissors

Please make your selection (rock/paper/scissors):

rock paper scissors
You played: rock paper scissors
The computer played: scissors
You win! Play again?
Congrats, here's the flag!
picoCTF{50M3_3X7R3M3_1UCK_58F0F41B}
Type '1' to play a game
Type '2' to exit the program
```

## Flag
    picoCTF{50M3_3X7R3M3_1UCK_58F0F41B}